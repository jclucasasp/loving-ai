import{r as t,j as e,f as ne,D as Le,g as He,u as Ve,C as $e,a as Ge,b as ze,d as qe,B as Ue,P as je,t as ue,T as ye}from"./index-BcDUjC1K.js";import{u as Je,F as Ke,a as X,b as Y,L as Z,c as ee,I as de,d as te,t as Qe}from"./input-Bw7JxDoU.js";import{V as Xe}from"./user-auth-api-DCxgQXI3.js";var Ye=Object.defineProperty,Ze=Object.defineProperties,et=Object.getOwnPropertyDescriptors,re=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,Se=(a,o,n)=>o in a?Ye(a,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[o]=n,tt=(a,o)=>{for(var n in o||(o={}))Pe.call(o,n)&&Se(a,n,o[n]);if(re)for(var n of re(o))Ee.call(o,n)&&Se(a,n,o[n]);return a},nt=(a,o)=>Ze(a,et(o)),rt=(a,o)=>{var n={};for(var i in a)Pe.call(a,i)&&o.indexOf(i)<0&&(n[i]=a[i]);if(a!=null&&re)for(var i of re(a))o.indexOf(i)<0&&Ee.call(a,i)&&(n[i]=a[i]);return n},at="^\\d+$";function ot(a){let o=setTimeout(a,0),n=setTimeout(a,10),i=setTimeout(a,50);return[o,n,i]}function lt(a){let o=t.useRef();return t.useEffect(()=>{o.current=a}),o.current}var st=18,Ce=40,it=`${Ce}px`,ct=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function ut({containerRef:a,inputRef:o,pushPasswordManagerStrategy:n,isFocused:i}){let c=t.useRef({done:!1,refocused:!1}),[u,b]=t.useState(!1),[w,q]=t.useState(!1),[N,U]=t.useState(!1),ae=t.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&u&&w,[u,w,n]),M=t.useCallback(()=>{let v=a.current,f=o.current;if(!v||!f||N||n==="none")return;let s=v,y=s.getBoundingClientRect().left+s.offsetWidth,A=s.getBoundingClientRect().top+s.offsetHeight/2,J=y-st,K=A;if(!(document.querySelectorAll(ct).length===0&&document.elementFromPoint(J,K)===v)&&(b(!0),U(!0),!c.current.refocused&&document.activeElement===f)){let L=[f.selectionStart,f.selectionEnd];f.blur(),f.focus(),f.setSelectionRange(L[0],L[1]),c.current.refocused=!0}},[a,o,N,n]);return t.useEffect(()=>{let v=a.current;if(!v||n==="none")return;function f(){let y=window.innerWidth-v.getBoundingClientRect().right;q(y>=Ce)}f();let s=setInterval(f,1e3);return()=>{clearInterval(s)}},[a,n]),t.useEffect(()=>{let v=i||document.activeElement===o.current;if(n==="none"||!v)return;let f=setTimeout(M,0),s=setTimeout(M,2e3),y=setTimeout(M,5e3),A=setTimeout(()=>{U(!0)},6e3);return()=>{clearTimeout(f),clearTimeout(s),clearTimeout(y),clearTimeout(A)}},[o,i,n,M]),{hasPWMBadge:u,willPushPWMBadge:ae,PWM_BADGE_SPACE_WIDTH:it}}var Me=t.createContext({}),Te=t.forwardRef((a,o)=>{var n=a,{value:i,onChange:c,maxLength:u,textAlign:b="left",pattern:w=at,inputMode:q="numeric",onComplete:N,pushPasswordManagerStrategy:U="increase-width",containerClassName:ae,noScriptCSSFallback:M=dt,render:v,children:f}=n,s=rt(n,["value","onChange","maxLength","textAlign","pattern","inputMode","onComplete","pushPasswordManagerStrategy","containerClassName","noScriptCSSFallback","render","children"]),y,A,J,K,L;let[Oe,Ie]=t.useState(typeof s.defaultValue=="string"?s.defaultValue:""),m=i??Oe,T=lt(m),H=t.useCallback(r=>{c==null||c(r),Ie(r)},[c]),j=t.useMemo(()=>w?typeof w=="string"?new RegExp(w):w:null,[w]),p=t.useRef(null),oe=t.useRef(null),le=t.useRef({value:m,onChange:H,isIOS:typeof window<"u"&&((A=(y=window==null?void 0:window.CSS)==null?void 0:y.supports)==null?void 0:A.call(y,"-webkit-touch-callout","none"))}),Q=t.useRef({prev:[(J=p.current)==null?void 0:J.selectionStart,(K=p.current)==null?void 0:K.selectionEnd,(L=p.current)==null?void 0:L.selectionDirection]});t.useImperativeHandle(o,()=>p.current,[]),t.useEffect(()=>{let r=p.current,l=oe.current;if(!r||!l)return;le.current.value!==r.value&&le.current.onChange(r.value),Q.current.prev=[r.selectionStart,r.selectionEnd,r.selectionDirection];function h(){if(document.activeElement!==r){$(null),G(null);return}let d=r.selectionStart,x=r.selectionEnd,P=r.selectionDirection,k=r.maxLength,O=r.value,_=Q.current.prev,E=-1,C=-1,I;if(O.length!==0&&d!==null&&x!==null){let Be=d===x,We=d===O.length&&O.length<k;if(Be&&!We){let F=d;if(F===0)E=0,C=1,I="forward";else if(F===k)E=F-1,C=F,I="backward";else if(k>1&&O.length>1){let ce=0;if(_[0]!==null&&_[1]!==null){I=F<_[1]?"backward":"forward";let _e=_[0]===_[1]&&_[0]<k;I==="backward"&&!_e&&(ce=-1)}E=ce+F,C=ce+F+1}}E!==-1&&C!==-1&&E!==C&&p.current.setSelectionRange(E,C,I)}let be=E!==-1?E:d,we=C!==-1?C:x,Ae=I??P;$(be),G(we),Q.current.prev=[be,we,Ae]}if(document.addEventListener("selectionchange",h,{capture:!0}),h(),document.activeElement===r&&se(!0),!document.getElementById("input-otp-style")){let d=document.createElement("style");if(d.id="input-otp-style",document.head.appendChild(d),d.sheet){let x="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";z(d.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),z(d.sheet,`[data-input-otp]:autofill { ${x} }`),z(d.sheet,`[data-input-otp]:-webkit-autofill { ${x} }`),z(d.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),z(d.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let g=()=>{l&&l.style.setProperty("--root-height",`${r.clientHeight}px`)};g();let S=new ResizeObserver(g);return S.observe(r),()=>{document.removeEventListener("selectionchange",h,{capture:!0}),S.disconnect()}},[]);let[me,fe]=t.useState(!1),[V,se]=t.useState(!1),[R,$]=t.useState(null),[B,G]=t.useState(null);t.useEffect(()=>{ot(()=>{var r,l,h,g;(r=p.current)==null||r.dispatchEvent(new Event("input"));let S=(l=p.current)==null?void 0:l.selectionStart,d=(h=p.current)==null?void 0:h.selectionEnd,x=(g=p.current)==null?void 0:g.selectionDirection;S!==null&&d!==null&&($(S),G(d),Q.current.prev=[S,d,x])})},[m,V]),t.useEffect(()=>{T!==void 0&&m!==T&&T.length<u&&m.length===u&&(N==null||N(m))},[u,N,T,m]);let W=ut({containerRef:oe,inputRef:p,pushPasswordManagerStrategy:U,isFocused:V}),he=t.useCallback(r=>{let l=r.currentTarget.value.slice(0,u);if(l.length>0&&j&&!j.test(l)){r.preventDefault();return}typeof T=="string"&&l.length<T.length&&document.dispatchEvent(new Event("selectionchange")),H(l)},[u,H,T,j]),ve=t.useCallback(()=>{var r;if(p.current){let l=Math.min(p.current.value.length,u-1),h=p.current.value.length;(r=p.current)==null||r.setSelectionRange(l,h),$(l),G(h)}se(!0)},[u]),ge=t.useCallback(r=>{var l,h;let g=p.current;if(!le.current.isIOS||!r.clipboardData||!g)return;let S=r.clipboardData.getData("text/plain");r.preventDefault();let d=(l=p.current)==null?void 0:l.selectionStart,x=(h=p.current)==null?void 0:h.selectionEnd,P=(d!==x?m.slice(0,d)+S+m.slice(x):m.slice(0,d)+S+m.slice(d)).slice(0,u);if(P.length>0&&j&&!j.test(P))return;g.value=P,H(P);let k=Math.min(P.length,u-1),O=P.length;g.setSelectionRange(k,O),$(k),G(O)},[u,H,j,m]),Fe=t.useMemo(()=>({position:"relative",cursor:s.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[s.disabled]),xe=t.useMemo(()=>({position:"absolute",inset:0,width:W.willPushPWMBadge?`calc(100% + ${W.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:W.willPushPWMBadge?`inset(0 ${W.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:b,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[W.PWM_BADGE_SPACE_WIDTH,W.willPushPWMBadge,b]),De=t.useMemo(()=>t.createElement("input",nt(tt({autoComplete:s.autoComplete||"one-time-code"},s),{"data-input-otp":!0,"data-input-otp-mss":R,"data-input-otp-mse":B,inputMode:q,pattern:j==null?void 0:j.source,style:xe,maxLength:u,value:m,ref:p,onPaste:r=>{var l;ge(r),(l=s.onPaste)==null||l.call(s,r)},onChange:he,onMouseOver:r=>{var l;fe(!0),(l=s.onMouseOver)==null||l.call(s,r)},onMouseLeave:r=>{var l;fe(!1),(l=s.onMouseLeave)==null||l.call(s,r)},onFocus:r=>{var l;ve(),(l=s.onFocus)==null||l.call(s,r)},onBlur:r=>{var l;se(!1),(l=s.onBlur)==null||l.call(s,r)}})),[he,ve,ge,q,xe,u,B,R,s,j==null?void 0:j.source,m]),ie=t.useMemo(()=>({slots:Array.from({length:u}).map((r,l)=>{let h=V&&R!==null&&B!==null&&(R===B&&l===R||l>=R&&l<B),g=m[l]!==void 0?m[l]:null;return{char:g,isActive:h,hasFakeCaret:h&&g===null}}),isFocused:V,isHovering:!s.disabled&&me}),[V,me,u,B,R,s.disabled,m]),Ne=t.useMemo(()=>v?v(ie):t.createElement(Me.Provider,{value:ie},f),[f,ie,v]);return t.createElement(t.Fragment,null,M!==null&&t.createElement("noscript",null,t.createElement("style",null,M)),t.createElement("div",{ref:oe,"data-input-otp-container":!0,style:Fe,className:ae},Ne,t.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},De)))});Te.displayName="Input";function z(a,o){try{a.insertRule(o)}catch{console.error("input-otp could not insert CSS rule:",o)}}var dt=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const Re=t.forwardRef(({className:a,containerClassName:o,...n},i)=>e.jsx(Te,{ref:i,containerClassName:ne("flex items-center gap-2 has-[:disabled]:opacity-50",o),className:ne("disabled:cursor-not-allowed",a),...n}));Re.displayName="InputOTP";const pe=t.forwardRef(({className:a,...o},n)=>e.jsx("div",{ref:n,className:ne("flex items-center",a),...o}));pe.displayName="InputOTPGroup";const D=t.forwardRef(({index:a,className:o,...n},i)=>{const c=t.useContext(Me),{char:u,hasFakeCaret:b,isActive:w}=c.slots[a];return e.jsxs("div",{ref:i,className:ne("relative flex h-9 w-9 items-center justify-center border-y border-r border-input text-sm shadow-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",w&&"z-10 ring-1 ring-ring",o),...n,children:[u,b&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});D.displayName="InputOTPSlot";const ke=t.forwardRef(({...a},o)=>e.jsx("div",{ref:o,role:"separator",...a,children:e.jsx(Le,{})}));ke.displayName="InputOTPSeparator";function ht(){const{email:a}=He().state||{email:""},o=Ve(),n=Je({resolver:Qe(je),defaultValues:{email:a,otp:"",password:"",confirm:""}}),i=async c=>{const u=je.safeParse(c);if(!u.success){ue({title:"Validation failed.",description:u.error.message,variant:"destructive",action:e.jsx(ye,{altText:"Retry",children:"Retry"}),duration:3e3});return}const b=await Xe(c.email,c.otp,c.password);if(!b||b.status==401){ue({title:"OTP verification failed.",description:"Either your OTP is invalid or have expired.",variant:"destructive",duration:3e3});return}if(b.status>=500){ue({title:"Error resetting password.",description:"Please try again. If the problem persists, please email us on lovingaiteam@gmail.com.",variant:"destructive",action:e.jsx(ye,{altText:"Okay",children:"Okay"}),duration:7e3});return}o("/login",{state:{email:c.email,password:c.password}})};return e.jsx("section",{className:"mt-24",children:e.jsxs($e,{className:"max-w-sm",children:[e.jsx(Ge,{children:e.jsx(ze,{children:"Password Reset"})}),e.jsx(qe,{children:e.jsx(Ke,{...n,children:e.jsxs("form",{className:"flex flex-col gap-2",onSubmit:n.handleSubmit(i),children:[e.jsx(X,{name:"email",control:n.control,render:({field:c})=>e.jsxs(Y,{hidden:!0,children:[e.jsx(Z,{htmlFor:"email",children:"Email"}),e.jsx(ee,{children:e.jsx(de,{...c,id:"email",type:"email"})}),e.jsx(te,{})]})}),e.jsx(X,{name:"otp",control:n.control,render:({field:c})=>e.jsxs(Y,{children:[e.jsx(Z,{htmlFor:"otp",children:"Enter the OTP from your email"}),e.jsx(ee,{children:e.jsxs(Re,{maxLength:6,...c,children:[e.jsxs(pe,{children:[e.jsx(D,{index:0}),e.jsx(D,{index:1}),e.jsx(D,{index:2})]}),e.jsx(ke,{}),e.jsxs(pe,{children:[e.jsx(D,{index:3}),e.jsx(D,{index:4}),e.jsx(D,{index:5})]})]})}),e.jsx(te,{})]})}),e.jsx(X,{name:"password",control:n.control,render:({field:c})=>e.jsxs(Y,{children:[e.jsx(Z,{htmlFor:"password",children:"Password"}),e.jsx(ee,{children:e.jsx(de,{...c,id:"password",type:"password"})}),e.jsx(te,{})]})}),e.jsx(X,{name:"confirm",control:n.control,render:({field:c})=>e.jsxs(Y,{children:[e.jsx(Z,{htmlFor:"confirm",children:"Confirm Password"}),e.jsx(ee,{children:e.jsx(de,{...c,id:"confirm",type:"password"})}),e.jsx(te,{})]})}),e.jsx(Ue,{type:"submit",variant:"secondary",className:"border w-full rounded-full mt-6 p-2",children:"Reset"})]})})})]})})}export{ht as default};
