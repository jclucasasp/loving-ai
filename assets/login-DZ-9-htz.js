import{j as e,C as y,a as F,d as b,f as O,r as u,a9 as I,u as E,b as R,B as h,e as A,an as p,T as d,s as q,ao as H,z as B}from"./index-BBk-v4uc.js";import{u as M,F as V,a as j,b as f,g,d as w,e as v,t as z}from"./zod-B8GwMsbf.js";import{b as U,O as W}from"./user-auth-api-D1J6RmD5.js";import{S as a}from"./skeleton-CAtbzpXi.js";import{I as N}from"./input-DBjIDQrj.js";import{H as _}from"./heart-BrYsQICc.js";import{L as D}from"./loader-circle-BWMZQt0x.js";function G(){return e.jsx("div",{children:e.jsxs(y,{children:[e.jsx(F,{className:"flex items-center",children:e.jsx(a,{className:"h-[30px] w-[200px] rounded-xl"})}),e.jsxs(b,{className:"flex flex-col gap-4",children:[e.jsx(a,{className:"h-[30px] w-[80px] rounded-xl"}),e.jsxs("div",{className:"flex gap-6",children:[e.jsx(a,{className:"h-[40px] w-[110px] rounded-xl"}),e.jsx(a,{className:"h-[40px] w-[110px] rounded-xl"})]}),e.jsx(a,{className:"h-[30px] w-[100px] rounded-xl"}),e.jsx(a,{className:"h-[40px] w-full rounded-xl"}),e.jsx(a,{className:"h-[30px] w-[120px] rounded-xl"}),e.jsx(a,{className:"h-[40px] w-full rounded-xl"}),e.jsx(a,{className:"h-[40px] w-full rounded-full mt-3"})]})]})})}function ee(){const{email:L,password:T}=O().state||{email:"",password:""},[n,m]=u.useState(!1),[k,x]=u.useState(!1),{toast:i}=I(),r=M({resolver:z(p),defaultValues:{email:L,password:T}}),o=E(),C=s=>{const t=p.safeParse(s);t.success&&S(t.data)},S=async s=>{x(!0);const t=await U(s.email,s.password);if(x(!1),!t){i({title:"Login Failed",variant:"destructive",action:e.jsx(d,{altText:"Retry",children:"Retry"}),duration:3e3});return}q(t.profile),H(t.accessToken),o("/profile")},P=async s=>{const c=B.string({required_error:"Email is required"}).email({message:"Must be a valid email"}).safeParse(s.email);if(!c.success){i({title:"Please enter a valid email.",variant:"destructive",duration:3e3});return}m(!0);const l=await W(c.data);if(m(!1),l&&l.status>=400&&l.status<500){i({title:"Email does not exist",description:"Please check if you have a typo in your email. If you are new here, you need to sign up first.",variant:"destructive",action:e.jsx(d,{altText:"Okay",children:"Okay"}),duration:5e3});return}if(!l||l.status>=500){i({title:"Error sending OTP.",description:"Please try again. If the problem persists, please email us on lovingaiteam@gmail.com.",variant:"destructive",action:e.jsx(d,{altText:"Okay",children:"Okay"}),duration:7e3});return}o("/reset",{state:{email:c.data}})};return e.jsxs("section",{className:"mt-24",children:[n&&e.jsx(G,{}),!n&&e.jsxs(y,{children:[e.jsxs(F,{className:"text-center text-2xl",children:[e.jsx("div",{className:"flex justify-center mb-3",children:e.jsx("img",{src:_,alt:"heart with arrow through it",height:80,width:80})}),e.jsx(R,{className:"text-[#FF0066]",children:"Welcome to Loving AI"})]}),e.jsx(b,{children:e.jsx(V,{...r,children:e.jsxs("form",{className:"flex flex-col gap-2",onSubmit:r.handleSubmit(C),children:[e.jsx(j,{name:"email",control:r.control,render:({field:s})=>e.jsxs(f,{children:[e.jsx(g,{htmlFor:"email",children:"Email"}),e.jsx(w,{children:e.jsx(N,{...s,id:"email",type:"email"})}),e.jsx(v,{})]})}),e.jsx(j,{name:"password",control:r.control,render:({field:s})=>e.jsxs(f,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(g,{htmlFor:"password",children:"Password"}),e.jsx("span",{className:"text-slate-400 cursor-pointer text-sm select-none",onClick:()=>P(r.getValues()),children:"Forgot Password?"})]}),e.jsx(w,{children:e.jsx(N,{...s,id:"password",type:"password"})}),e.jsx(v,{})]})}),e.jsxs(h,{type:"submit",variant:"special",disabled:n,className:"border w-full rounded-full mt-6 p-2",children:[k&&e.jsx("span",{children:e.jsx(D,{className:"mr-2 h-4 w-4 animate-spin"})}),"Login"]})]})})}),e.jsx(A,{children:e.jsx(h,{variant:"link",onClick:()=>o("/personality"),className:"text-slate-400",children:'Don"t have an account? Sign up'})})]})]})}export{ee as default};
