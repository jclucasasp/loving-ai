import{f as B,u as A,r as m,j as e,C as M,d as V,B as N,e as R,i as b,t as j,T as u,U as O}from"./index-D4mIyDY3.js";import{G as k}from"./personality-api-4KZjFyEd.js";import{u as G,t as D,F as H,a as t,b as i,d as l,f as n,e as o}from"./zod-w8ZB2__i.js";import{T as J}from"./index-D6pfUyqx.js";import{L as q}from"./user-auth-api-DmC2IQ7V.js";import{I as d}from"./input-D60G2rH7.js";import{S,a as v,b as F,c as P,d as h}from"./select-CaLy4yal.js";import{C as z}from"./component-heading-B58O_hC6.js";import{L as T}from"./loader-circle-C2DSn0HB.js";import"./Combination-q1_JiVcj.js";import"./component-CmFLIqT1.js";function se(){const s=B(),p=A(),[x,f]=m.useState(!1),a=G({resolver:D(b),defaultValues:{userId:s==null?void 0:s.userId,firstName:s==null?void 0:s.firstName,lastName:s==null?void 0:s.lastName,age:s==null?void 0:s.age,ethnicity:s==null?void 0:s.ethnicity,gender:s==null?void 0:s.gender,bio:s==null?void 0:s.bio,imageUrl:s==null?void 0:s.imageUrl,myersBriggsPersonalityType:s==null?void 0:s.myersBriggsPersonalityType,verified:s==null?void 0:s.verified}}),[C,L]=m.useState([]),w=async()=>await k(),E=async r=>{f(!0);const c=b.safeParse(r);if(!c.success){j({title:"Validation failed.",description:c.error.message,variant:"destructive",action:e.jsx(u,{altText:"Retry",children:"Retry"})});return}const y=await O(c.data);if(f(!1),!y.userId){console.error("Failed to update profile"),j({title:"Failed to update profile",description:"Failed to update profile",variant:"destructive",action:e.jsx(u,{altText:"Retry",children:"Retry"})});return}sessionStorage.clear(),sessionStorage.setItem("loggedInUser",btoa(JSON.stringify(y))),p("/profile"),j({title:"Profile updated successfully",action:e.jsx(u,{altText:"Okay",children:"Okay"})})},Y=async()=>{sessionStorage.clear(),await q(s.userId),p("/")};return m.useEffect(()=>{w().then(r=>{L(r)})},[]),e.jsxs(e.Fragment,{children:[e.jsx(z,{children:"User Profile"}),e.jsxs(M,{className:"w-full",children:[e.jsx(V,{children:e.jsx(H,{...a,children:e.jsxs("form",{className:"flex flex-col gap-2",onSubmit:a.handleSubmit(E),children:[e.jsx(t,{control:a.control,name:"userId",render:({field:r})=>e.jsx(i,{children:e.jsx(l,{children:e.jsx(d,{type:"hidden",placeholder:s==null?void 0:s.userId,...r})})})}),e.jsx(t,{control:a.control,name:"firstName",render:({field:r})=>e.jsxs(i,{children:[e.jsx(n,{children:"Your first name"}),e.jsx(l,{children:e.jsx(d,{type:"text",placeholder:s==null?void 0:s.firstName,...r})}),e.jsx(o,{})]})}),e.jsx(t,{control:a.control,name:"lastName",render:({field:r})=>e.jsxs(i,{children:[e.jsx(n,{children:"Your last name"}),e.jsx(l,{children:e.jsx(d,{type:"text",placeholder:s==null?void 0:s.lastName,...r})}),e.jsx(o,{})]})}),e.jsx(t,{control:a.control,name:"age",render:({field:r})=>e.jsxs(i,{children:[e.jsx(n,{children:"Your age"}),e.jsx(l,{children:e.jsx(d,{type:"number",...r})}),e.jsx(o,{})]})}),e.jsx(t,{control:a.control,name:"ethnicity",render:({field:r})=>e.jsxs(i,{children:[e.jsx(n,{children:"Your ethnicity"}),e.jsx(l,{children:e.jsx(d,{type:"text",placeholder:s==null?void 0:s.ethnicity,...r})}),e.jsx(o,{})]})}),e.jsx(t,{control:a.control,name:"bio",render:({field:r})=>e.jsxs(i,{children:[e.jsx(n,{children:"Your bio"}),e.jsx(l,{children:e.jsx(J,{rows:5,placeholder:s==null?void 0:s.bio,...r})}),e.jsx(o,{})]})}),e.jsx(t,{control:a.control,name:"imageUrl",render:({field:r})=>e.jsxs(i,{hidden:!0,children:[e.jsx(n,{children:"Your image url"}),e.jsx(l,{children:e.jsx(d,{type:"text",placeholder:s==null?void 0:s.imageUrl,...r})}),e.jsx(o,{})]})}),e.jsx(t,{control:a.control,name:"gender",render:({field:r})=>e.jsxs(i,{children:[e.jsx(n,{children:"Your Gender"}),e.jsxs(S,{onValueChange:r.onChange,defaultValue:r.value,children:[e.jsx(l,{children:e.jsx(v,{className:"w-full",children:e.jsx(F,{})})}),e.jsxs(P,{children:[e.jsx(h,{value:"MALE",children:"MALE"}),e.jsx(h,{value:"FEMALE",children:"FEMALE"})]}),e.jsx(o,{})]})]})}),e.jsx(t,{control:a.control,name:"myersBriggsPersonalityType",render:({field:r})=>e.jsxs(i,{children:[e.jsx(n,{children:"Your Myers Briggs Personality Type"}),e.jsxs(S,{onValueChange:r.onChange,children:[e.jsx(l,{children:e.jsx(v,{className:"w-full",children:e.jsx(F,{placeholder:s==null?void 0:s.myersBriggsPersonalityType})})}),e.jsxs(P,{children:[C.map(c=>e.jsx(h,{value:c.type,children:c.type},c.id))," "]}),e.jsx(o,{})]})]})}),e.jsxs(N,{disabled:x,variant:"special",type:"submit",className:"mt-3 w-full rounded-full","aria-label":"Update profile",children:[x&&e.jsx("span",{children:e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"})}),"Update Profile"]})]})})}),e.jsx(R,{children:e.jsxs(N,{disabled:x,variant:"destructive",className:"w-full rounded-full",onClick:()=>Y(),"aria-label":"Log out",children:[x&&e.jsx("span",{children:e.jsx(T,{className:"mr-2 h-4 w-4 animate-spin"})}),"Log Out"]})})]})]})}export{se as default};
